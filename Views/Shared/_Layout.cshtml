<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta property="og:url" content="https://tickets.atthetop.ae/FBApp/" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="burj khalifa" />
    <meta property="og:description" content="" />
    <meta property="og:image" content="http://www.your-domain.com/path/image.jpg" />

    <title>Burj | Khalifa</title>
    @Styles.Render("~/Content/css")

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>



</head>
<body class="">
    <div class="wrapper">
        <div class="main-header">
            <div class="header">
                <div class="row">
                    <div class="col-sm-6"><a class="logo" href="@Url.Action("Index", "Home")"><img class="img-responsive" src="@Url.Content("~/Content/images/logo.png")" alt=""></a></div>
                    <div class="col-sm-6"><div class="top-link">Tickets Information</div></div>
                </div>
            </div>
            @if (ViewBag.Title != "_HomePage")
            {
                <div class="banner">
                    <div class="row">
                        <div class="col-sm-12">

                            @if (ViewBag.Title == "Attraction")
                            {
                                <div class="attbanner-bg" )">@*<div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div>*@</div>
                            }
                            else if (ViewBag.Title == "SelectDay")
                            {
                                <div class="sdbanner-bg">@*<div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div>*@</div>
                            }
                            else if (ViewBag.Title == "SelectTime")
                            {
                                <div class="stbanner-bg">@*<div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div>*@</div>
                            }
                            else if (ViewBag.Title == "PersonalInformation")
                            {
                                <div class="pibanner-bg">@*<div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div>*@</div>
                            }
                            else if (ViewBag.Title == "SelectTicket")
                            {
                                <div class="stktbanner-bg">@*<div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div>*@</div>
                            }
                            else if (ViewBag.Title == "PayTicket")
                            {
                                <div class="ptbanner-bg">@*<div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div>*@</div>
                            }
                            else
                            {
                                <div class="banner-bg"><div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div></div>
                            }
                            @* <div class="banner-bg"><div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div></div>*@
                            @*<div id="sliderFrame" >
                                    <div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div>
                                    <div id="slider">
                                        <img src="~/Content/images/banner-1.png" width="100%"/>
                                        <img src="~/Content/images/banner-2.jpg" width="100%" alt="" />
                                        <img src="~/Content/images/banner-3.jpg" width="100%" alt="" />
                                    </div>
                                    <div id="htmlcaption" style="display: none;">
                                        <div class="banner-bg"><div class="page-heading"><h1 class="page-title"><b>Book</b> Tickets</h1><span class="line"><hr></span></div></div>
                                    </div>
                                </div>*@
                        </div>
                    </div>
                </div>
                if (ViewBag.Title != "CustomError" && ViewBag.Title != "ContactUs" && ViewBag.Title != "SessionTimeOut" && ViewBag.Title != "ViewPromotion" && ViewBag.Title != "PaymentFail")
                {
                    <div class="main-menu">
                        <div class="row">
                            <div class="col-sm-12">
                                <nav class="navbar navbar-default">
                                    <div class="navbar-header">
                                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu" aria-expanded="false">
                                            <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
                                        </button>
                                    </div>

                                    <!-- Collect the nav links, forms, and other content for toggling -->
                                    <div class="collapse navbar-collapse" id="main-menu">

                                        <ul class="nav navbar-nav">
                                            <li class="first @Html.ActiveTab("Home", new string[] { "SelectDate", "SelectPersons", "SelectDay" }, "active") @Html.ActiveTab("Home", new string[] { "Tower", "Attraction", "Payment", "ViewPromotion", "SelectTime", "PersonalInformation", "SelectTicket", "PayTicket", "Thankyou" }, "done")">
                                                <a href="@Url.Action("SelectDay", "Home")"><b>1</b><span>Select your date</span></a>
                                            </li>
                                            <li class="@Html.ActiveTab("Home", new string[] { "Attraction","Tower" }, "active") @Html.ActiveTab("Home", new string[] { "ViewPromotion", "Payment", "SelectTime", "PersonalInformation", "SelectTicket", "PayTicket", "Thankyou" }, "done")">
                                                <a href="@(SessionVariables.Date != null ? Url.Action("Attraction", "Home") : "javascript:void(0);")"><b>2</b><span>Select attraction</span></a>
                                            </li>
                                            <li class="@Html.ActiveTab("Home", new string[] { "SelectTime" }, "active") @Html.ActiveTab("Home", new string[] { "PersonalInformation", "Payment", "SelectTicket", "PayTicket", "Thankyou" }, "done")">
                                                <a href="@(SessionVariables.ResourceId > 0 && SessionVariables.EventId > 0 ? Url.Action("SelectTime", "Home") : "javascript:void(0);")"><b>3</b><span>Select time</span></a>
                                            </li>
                                            <li class="@Html.ActiveTab("Home", new string[] { "PersonalInformation" }, "active") @Html.ActiveTab("Home", new string[] { "SelectTicket", "Payment", "PayTicket", "Thankyou" }, "done")">
                                                <a href="@(SessionVariables.Availalbe > 0 ? Url.Action("PersonalInformation", "Home") : "javascript:void(0);")"><b>4</b><span>Personal Information</span></a>
                                            </li>
                                            <li class="@Html.ActiveTab("Home", new string[] { "SelectTicket" }, "active") @Html.ActiveTab("Home", new string[] { "Thankyou", "Payment", "PayTicket" }, "done")">
                                                <a href="@(SessionVariables.CustomerID > 0 ? Url.Action("SelectTicket", "Home") : "javascript:void(0);")"><b>5</b><span>Select N° of tickets</span></a>
                                            </li>
                                            <li class="last @Html.ActiveTab("Home", new string[] { "Thankyou", "Payment", "PayTicket" }, "active")">
                                                <a href="@Url.Action("Thankyou", "Home")"><b>6</b><span>Complete purchase</span></a>
                                            </li>
                                        </ul>
                                    </div>
                                    <!-- /.navbar-collapse -->
                                </nav>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>

        <p name="countdown" style="display:none"></p>
        @RenderBody()

        @if (ViewBag.Title != "_HomePage")
            {
            <div class="footnote">Tickets can only be booked as far as 30 days ahead of the intended visit.</div>
        }
        <div class="footer">
            <div class="row">
                <div class="col-sm-2">
                    <ul class="social-icon">
                        <li><a href="javascript:void(0);"><i class="fa fa-facebook"></i></a></li>
                        <li><a href="javascript:void(0);"><i class="fa fa-twitter"></i></a></li>
                        <li><a href="javascript:void(0);"><i class="fa fa-instagram"></i></a></li>
                    </ul>
                </div>
                <div class="col-sm-7">
                    <div class="footer-menu">
                        <ul>
                            <li><a href="@Url.Action("ContactUs", "Home")">Contact Us</a></li>
                            @*<li><a href="javascript:void(0);">Sitemap</a></li>*@
                            <li><a href="javascript:void(0);">Privacy Policy</a></li>
                            @*<li><a href="javascript:void(0);">Emaar.com</a></li>
                                <li class="last"><a href="javascript:void(0);">Web Survey</a></li>*@
                        </ul>
                    </div>

                </div>
                <div class="col-sm-3">
                    <div class="copy-right">
                        <p>@@2016 Emaar PJSC</p>
                        <img src="@Url.Content("~/Content/images/footer-logo.png")">
                    </div>
                </div>
            </div>
        </div>
    </div>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    <link href="~/Scripts/Slider/generic.css" rel="stylesheet" type="text/css" />
    <script src="~/Scripts/Slider/js-image-slider.js" type="text/javascript"></script>
    <link href="~/Scripts/Slider/js-image-slider.css" rel="stylesheet" type="text/css" />
    <script>
        var accessToken;
        $(document).ready(function () {
            $('div[rel=0]').parent().remove();

            // $('.active a b').text('');
            $('.done a b').text('');

            if ("@ViewBag.Title" == "_HomePage") {
                $('body').addClass("home");
            }
            else {
                $('body').removeClass("home");
            }
            (function (d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) { return; }
                js = d.createElement(s); js.id = id;
                js.src = "//connect.facebook.net/en_US/sdk.js";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));


            function checkLoginState() {
                FB.getLoginStatus(function (response) {
                    statusChangeCallback(response);
                });
            }
            //timer
            if ("@ViewBag.Title" == "PayTicket") {
                var dt = '@SessionVariables.SessionTime';
                var dateAr = dt.split('-');
                var newDate = dateAr[1] + '/' + dateAr[0] + '/' + dateAr[2];

                var end = new Date(dateAr[1] + '/' + dateAr[0] + '/' + dateAr[2]);

                var _second = 1000;
                var _minute = _second * 60;
                var _hour = _minute * 60;
                var _day = _hour * 24;
                var timer;
                var now = new Date('@DateTime.Now');
                var distance = end - now;

                function showRemaining() {
                    distance = distance - 1000;

                    if ("@ViewBag.Title" == "Thankyou" || "@ViewBag.Title" == "PaymentFail" || "@ViewBag.Title" == "SessionTimeOut") {
                        clearInterval(timer);
                        return;
                    }
                    console.log(distance);
                    if (distance < 0) {
                        clearInterval(timer);
                        window.location = '@Url.Action("SessionTimeOut", "Home")';

                        return;
                    }
                    var minutes = Math.floor((distance % _hour) / _minute);
                    var seconds = Math.floor((distance % _minute) / _second);
                    if (minutes < 10) {
                        minutes = "0" + minutes;
                    }
                    if (seconds < 10) {
                        seconds = "0" + seconds;
                    }
                    $('p[name=countdown]').text(minutes + ':' + seconds + ' Minutes Remaining to Complete Payment for selected Tickets');
                }

                timer = setInterval(showRemaining, 1000);
            }
            //End timer
        });

        window.fbAsyncInit = function () {
            FB.init({
                appId: '@System.Configuration.ConfigurationManager.AppSettings["FBappId"]',//'297311063959457',//'1699222460356691',//461004573977001, //burjkhalifa:

                channelUrl: '//' + window.location.hostname + '/channel', // Path to your Channel File
                scope: 'id,name,gender,email,first_name,last_name,picture',//user_location',//user_birthday,user_hometown,age_range,link,locale,birthday
                status: true, // check login status
                cookie: true, // enable cookies to allow the server to access the session
                xfbml: true,
                version: '@System.Configuration.ConfigurationManager.AppSettings["FBversion"]',//'v2.5'
            });

            // ADD ADDITIONAL FACEBOOK CODE HERE
            function onLogin(response) {
                if (response.status == 'connected') {
                    FB.api('/me?fields=id,name,gender,email,first_name,last_name,picture.type(large)', LoadValues);
                }
            }

            FB.getLoginStatus(function (response) {
                if (response.status == 'connected') {
                    accessToken = response.authResponse.accessToken;
                    onLogin(response);
                } else {

                    if ("@ViewBag.Title" != "_HomePage") {
                        window.location = '@Url.Action("Index", "Home")'
                        return false;
                    }
                    FB.login(function (response) {
                        onLogin(response);
                    }, { scope: 'user_friends, email, public_profile,,publish_actions' });


                }
            });

            function statusChangeCallback(response) {
                console.log('statusChangeCallback');
                console.log(response);
                if (response.status === 'connected') {
                    testAPI();
                } else if (response.status === 'not_authorized') {
                    document.getElementById('status').innerHTML = 'Please log ' +
                      'into this app.';
                } else {
                    document.getElementById('status').innerHTML = 'Please log ' +
                      'into Facebook.';
                }
            }
            function testAPI() {
                console.log('Welcome!  Fetching your information.... ');
                FB.api('/me', function (response) {
                    console.log('Successful login for: ' + response.name);
                    document.getElementById('status').innerHTML =
                      'Thanks for logging in, ' + response.name + '!';
                });
            }
        };
        //This method will load the values to the labels
        function LoadValues(me) {
            if (me.name) {
                if ('@ViewBag.Title' == "PersonalInformation") {
                    document.getElementById('FirstName').value = me.first_name;
                    document.getElementById('LastName').value = me.last_name;
                    if (me.email != "") {
                        document.getElementById('email').value = me.email;
                        document.getElementById('ConfirmEmail').value = me.email;
                    }
                }

                if ('@ViewBag.Title' == "Thankyou") {
                    $('#profilepic').attr('src', me.picture.data.url);
                }
            }
        }
        $('.top-link').click(function () {
            window.location = './#ticketinfo';
        });


        $(document).ready(function () {
            //if (window.location.host != "https://apps.facebook.com/") {
            //    document.body.innerHTML = "Access Denied";
            //    return;
            //}

            $('div[rel=0]').parent().remove();

           // $('.active a b').text('');
            $('.done a b').text('');

        });


    </script>

    @RenderSection("scripts", required: false)

</body>
</html>
